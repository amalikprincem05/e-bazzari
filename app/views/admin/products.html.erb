<div class="py-5">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="fas fa-box me-2"></i>Manage Products</h1>
      <div>
        <%= link_to "Add New Product", admin_new_product_path, class: "btn btn-primary" %>
        <%= link_to "Dashboard", admin_dashboard_path, class: "btn btn-outline-secondary" %>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <% if @products.any? %>
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Name</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Stock</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% @products.each do |product| %>
                  <tr>
                    <td>
                      <% if product.image.attached? %>
                        <%= image_tag product.image, class: "img-thumbnail", style: "width: 50px; height: 50px; object-fit: cover;" %>
                      <% else %>
                        <div class="bg-light d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                          <i class="fas fa-image text-muted"></i>
                        </div>
                      <% end %>
                    </td>
                    <td>
                      <strong><%= product.name %></strong>
                      <br>
                      <small class="text-muted"><%= product.description&.truncate(50) %></small>
                    </td>
                    <td>
                      <span class="badge bg-secondary"><%= product.category %></span>
                    </td>
                    <td><strong>$<%= product.price %></strong></td>
                    <td>
                      <span class="badge bg-<%= product.stock_quantity > 10 ? 'success' : product.stock_quantity > 0 ? 'warning' : 'danger' %>">
                        <%= product.stock_quantity %>
                      </span>
                    </td>
                    <td>
                      <% if product.available? %>
                        <span class="badge bg-success">Available</span>
                      <% else %>
                        <span class="badge bg-danger">Out of Stock</span>
                      <% end %>
                    </td>
                    <td>
                      <div class="btn-group" role="group">
                        <%= link_to "Edit", admin_edit_product_path(product), class: "btn btn-sm btn-outline-primary" %>
                        <%= button_to "Delete", admin_delete_product_path(product), method: :delete, 
                            class: "btn btn-sm btn-outline-danger", 
                            data: { confirm: "Are you sure you want to delete this product?" },
                            local: true %>
                      </div>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="text-center py-5">
            <i class="fas fa-box fa-5x text-muted mb-3"></i>
            <h3>No products yet</h3>
            <p class="text-muted">Start by adding your first product!</p>
            <%= link_to "Add New Product", admin_new_product_path, class: "btn btn-primary btn-lg" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
