<div class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h3><i class="fas fa-plus me-2"></i>Add New Product</h3>
          </div>
          <div class="card-body">
            <%= form_with model: @product, url: admin_create_product_path, local: true, multipart: true, class: "needs-validation", novalidate: true do |form| %>
              <% if @product.errors.any? %>
                <div class="alert alert-danger">
                  <h4><%= pluralize(@product.errors.count, "error") %> prohibited this product from being saved:</h4>
                  <ul>
                    <% @product.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                    <% end %>
                  </ul>
                </div>
              <% end %>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <%= form.label :name, class: "form-label" do %>
                    <i class="fas fa-tag me-2"></i>Product Name
                  <% end %>
                  <%= form.text_field :name, class: "form-control", placeholder: "Enter product name", required: true %>
                  <div class="invalid-feedback">
                    Please provide a product name.
                  </div>
                </div>

                <div class="col-md-6 mb-3">
                  <%= form.label :category, class: "form-label" do %>
                    <i class="fas fa-folder me-2"></i>Category
                  <% end %>
                  <%= form.select :category, options_for_select([
                    ['Electronics', 'Electronics'],
                    ['Clothing', 'Clothing'],
                    ['Home & Garden', 'Home & Garden'],
                    ['Sports', 'Sports'],
                    ['Books', 'Books'],
                    ['Beauty', 'Beauty'],
                    ['Toys', 'Toys'],
                    ['Automotive', 'Automotive']
                  ], @product.category), { prompt: 'Select a category' }, { class: "form-select", required: true } %>
                  <div class="invalid-feedback">
                    Please select a category.
                  </div>
                </div>
              </div>

              <div class="mb-3">
                <%= form.label :description, class: "form-label" do %>
                  <i class="fas fa-align-left me-2"></i>Description
                <% end %>
                <%= form.text_area :description, class: "form-control", rows: 4, placeholder: "Enter product description", required: true %>
                <div class="invalid-feedback">
                  Please provide a product description.
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <%= form.label :price, class: "form-label" do %>
                    <i class="fas fa-dollar-sign me-2"></i>Price
                  <% end %>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <%= form.number_field :price, class: "form-control", placeholder: "0.00", step: "0.01", min: "0", required: true %>
                  </div>
                  <div class="invalid-feedback">
                    Please provide a valid price.
                  </div>
                </div>

                <div class="col-md-6 mb-3">
                  <%= form.label :stock_quantity, class: "form-label" do %>
                    <i class="fas fa-boxes me-2"></i>Stock Quantity
                  <% end %>
                  <%= form.number_field :stock_quantity, class: "form-control", placeholder: "0", min: "0", required: true %>
                  <div class="invalid-feedback">
                    Please provide a valid stock quantity.
                  </div>
                </div>
              </div>

              <div class="mb-4">
                <%= form.label :image, class: "form-label" do %>
                  <i class="fas fa-image me-2"></i>Product Image
                <% end %>
                <%= form.file_field :image, class: "form-control", accept: "image/*" %>
                <div class="form-text">Upload a product image (JPG, PNG, GIF)</div>
              </div>

              <div class="card bg-light border-0 mb-4">
                <div class="card-body">
                  <h5 class="card-title mb-3"><i class="fas fa-bullhorn me-2 text-primary"></i>Promote as Featured Ad</h5>
                  <div class="form-check form-switch mb-3">
                    <%= form.check_box :featured_ad, class: "form-check-input", role: "switch" %>
                    <%= form.label :featured_ad, "Show this product in the homepage ads slider", class: "form-check-label" %>
                  </div>
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <%= form.label :featured_badge, class: "form-label" do %>
                        <i class="fas fa-star me-2 text-warning"></i>Badge Text
                      <% end %>
                      <%= form.text_field :featured_badge, class: "form-control", placeholder: "Featured / Hot Deal / New Drop" %>
                    </div>
                    <div class="col-md-6 mb-3">
                      <%= form.label :featured_priority, class: "form-label" do %>
                        <i class="fas fa-sort-amount-up me-2 text-warning"></i>Slider Priority
                      <% end %>
                      <%= form.number_field :featured_priority, class: "form-control", min: 0, value: @product.featured_priority || 0 %>
                      <small class="text-muted">Lower numbers appear first.</small>
                    </div>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-between">
                <%= link_to "Cancel", admin_products_path, class: "btn btn-secondary" %>
                <%= form.submit "Create Product", class: "btn btn-primary" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Bootstrap form validation
(function() {
  'use strict';
  window.addEventListener('load', function() {
    var forms = document.getElementsByClassName('needs-validation');
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script>
