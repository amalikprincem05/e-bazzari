<div class="py-5">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <% if @product.image.attached? %>
          <%= image_tag @product.image, class: "img-fluid rounded", style: "width: 100%; height: 400px; object-fit: cover;" %>
        <% else %>
          <div class="bg-light d-flex align-items-center justify-content-center rounded" style="height: 400px;">
            <i class="fas fa-image fa-5x text-muted"></i>
          </div>
        <% end %>
      </div>
      
      <div class="col-md-6">
        <h1 class="mb-3"><%= @product.name %></h1>
        <div class="mb-3">
          <span class="h3 text-primary">$<%= @product.price %></span>
          <span class="badge bg-<%= @product.available? ? 'success' : 'danger' %> ms-2">
            <%= @product.available? ? 'In Stock' : 'Out of Stock' %>
          </span>
        </div>
        
        <div class="mb-4">
          <h5>Description</h5>
          <p class="text-muted"><%= @product.description %></p>
        </div>
        
        <div class="mb-4">
          <h5>Category</h5>
          <span class="badge bg-secondary"><%= @product.category.titleize %></span>
        </div>
        
        <div class="mb-4">
          <h5>Stock</h5>
          <p class="text-muted"><%= @product.stock_quantity %> items available</p>
        </div>
        
        <% if user_signed_in? %>
          <% if @product.available? %>
            <%= form_with model: @cart_item, url: cart_items_path, method: :post, local: true, class: "mb-4" do |form| %>
              <%= form.hidden_field :product_id, value: @product.id %>
              <div class="row">
                <div class="col-md-4">
                  <%= form.number_field :quantity, value: 1, min: 1, max: @product.stock_quantity, class: "form-control" %>
                </div>
                <div class="col-md-8">
                  <%= form.submit "Add to Cart", class: "btn btn-primary btn-lg" %>
                </div>
              </div>
            <% end %>
          <% else %>
            <button class="btn btn-secondary btn-lg" disabled>Out of Stock</button>
          <% end %>
        <% else %>
          <div class="alert alert-info">
            <%= link_to "Sign in", new_user_session_path, class: "alert-link" %> to add items to your cart.
          </div>
        <% end %>
        
        <div class="mt-4">
          <%= link_to "â† Back to Shop", shop_path, class: "btn btn-outline-secondary" %>
        </div>
      </div>
    </div>
  </div>
</div>
